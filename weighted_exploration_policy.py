from agent import Agent
import numpy as np

class WeightedExplorationPolicy:
    def __init__(self, exploration_weight=0.2, num_actions=3):
        self.exploration_weight = exploration_weight
        self.num_actions = num_actions

    def select_action(self, agent: Agent) -> str:
        # Calculate the weighted sum of known rewards
        weighted_rewards = (1 - self.exploration_weight) * agent.known_rewards

        # Add exploration component for unknown rewards
        weighted_rewards += self.exploration_weight * np.random.rand(len(agent.known_rewards))

        # Choose action based on the weighted rewards
        action = np.argmax(weighted_rewards)

        # Ensure that the action is within the valid range
        action = np.clip(action, 0, self.num_actions - 1)

        return ["left", "right", "none"][action]
